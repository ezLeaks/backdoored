package com.backdoored.hacks.exploit;

import com.backdoored.hacks.*;
import a.a.g.b.*;
import com.backdoored.gui.*;
import com.backdoored.event.*;
import net.minecraft.network.play.server.*;
import net.minecraftforge.fml.common.eventhandler.*;
import com.backdoored.utils.*;
import java.util.*;
import a.a.a.*;

@b.a(name = "Vanish Detector", description = "Detect players in vanish", category = CategoriesInit.EXPLOIT)
public class VanishDetector extends BaseHack
{
    private final HashMap<UUID, String> qa;
    
    public VanishDetector() {
        super();
        this.qa = new HashMap<UUID, String>();
    }
    
    @SubscribeEvent
    public void a(final PacketRecieved packetRecieved) {
        if (packetRecieved.packet instanceof SPacketPlayerListItem && this.getEnabled()) {
            final SPacketPlayerListItem sPacketPlayerListItem = (SPacketPlayerListItem)packetRecieved.packet;
            if (sPacketPlayerListItem.getAction() == SPacketPlayerListItem.Action.UPDATE_LATENCY) {
                final HashSet<UUID> set = new HashSet<UUID>();
                for (final SPacketPlayerListItem.AddPlayerData addPlayerData : sPacketPlayerListItem.getEntries()) {
                    if (VanishDetector.mc.getConnection().getPlayerInfo(addPlayerData.getProfile().getId()) == null) {
                        set.add(addPlayerData.getProfile().getId());
                    }
                }
                new Thread(this::a, "Vanish thing idk").start();
            }
        }
    }
    
    public void onTick() {
        synchronized (this.qa) {
            for (final Map.Entry<UUID, String> entry : this.qa.entrySet()) {
                Utils.printMessage("PlayerPreviewElement " + entry.getValue() + " has gone into vanish (" + entry.getKey() + ")", "gold");
            }
            this.qa.clear();
        }
    }
    
    private /* synthetic */ void a(final Set set) {
        for (final UUID uuid : set) {
            this.qa.put(uuid, d.a(uuid.toString()));
        }
    }
}
